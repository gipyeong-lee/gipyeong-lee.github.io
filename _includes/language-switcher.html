{% comment %}
  Language switcher for multilingual posts.
  Uses the `ref` field in front matter to find translations of the same post.
{% endcomment %}

{% if page.ref %}
<div class="language-switcher">
  {% assign translations = site.posts | where: "ref", page.ref %}
  {% for lang in site.languages %}
    {% assign lang_name = site.language_names[lang] %}
    {% assign translation = translations | where: "lang", lang | first %}
    {% if translation %}
      {% if page.lang == lang %}
        <span class="language-switcher__item language-switcher__item--active">{{ lang_name }}</span>
      {% else %}
        <a href="{{ site.baseurl }}{{ translation.url }}" class="language-switcher__item">{{ lang_name }}</a>
      {% endif %}
    {% endif %}
  {% endfor %}
</div>
{% endif %}
